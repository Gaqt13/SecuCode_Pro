<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecuCode - ÙƒØ§Ø´Ù Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        body {
            background-color: #f0f4f8; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­ ÙˆÙ…Ù‡Ø¯Ø¦ */
            font-family: 'Tahoma', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .card-custom {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border-radius: 1rem;
            border: none;
            max-width: 650px;
        }
        .header-bg {
            background-color: #007bff;
            color: white;
            padding: 20px 0;
            border-top-left-radius: 1rem;
            border-top-right-radius: 1rem;
        }
        .result-box {
            min-height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 25px;
            padding: 15px;
            border-radius: 0.5rem;
            transition: all 0.4s;
        }
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .result-safe { background-color: #d4edda; color: #0f5132; border: 1px solid #badbcc; } /* Ø£Ø®Ø¶Ø± ÙØ§ØªØ­ */
        .result-medium { background-color: #fff3cd; color: #664d03; border: 1px solid #ffecb5; } /* Ø£ØµÙØ± ÙØ§ØªØ­ */
        .result-high { background-color: #f8d7da; color: #58151c; border: 1px solid #f5c2c7; } /* Ø£Ø­Ù…Ø± ÙØ§ØªØ­ */
        .result-loading { background-color: #e9ecef; color: #495057; border: 1px solid #ced4da; } /* Ø±Ù…Ø§Ø¯ÙŠ ÙØ§ØªØ­ */
    </style>
</head>
<body>
    <div class="container">
        <div class="card card-custom">
            <div class="header-bg text-center">
                <h1 class="display-6 mb-0">ğŸ” SecuCode - ÙØ§Ø­Øµ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h1>
                <p class="lead mt-2">Ù†Ø¸Ø§Ù… Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„ (Phishing)</p>
            </div>
            <div class="card-body p-4 p-md-5">
                <div class="mb-4">
                    <label for="linkInput" class="form-label fs-5">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡ Ù‡Ù†Ø§:</label>
                    <input type="url" id="linkInput" class="form-control form-control-lg" placeholder="Ù…Ø«Ø§Ù„: https://suspect.com/login" required>
                </div>
                
                <button onclick="checkLink()" class="btn btn-primary btn-lg w-100 mb-4">
                    <span id="buttonText">Ø§ÙØ­Øµ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¢Ù†</span>
                    <span id="spinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                </button>

                <div id="result" class="result-box result-loading">
                    Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ÙØ­Øµ...
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        async function checkLink() {
            const link = document.getElementById('linkInput').value;
            const resultDiv = document.getElementById('result');
            const button = document.querySelector('button');
            const buttonText = document.getElementById('buttonText');
            const spinner = document.getElementById('spinner');
            
            // ØªÙ‡ÙŠØ¦Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            resultDiv.className = 'result-box result-loading';
            resultDiv.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„... (ÙŠØªÙ… ÙØ­Øµ 7 Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ù…Ù†ÙŠØ©)";
            button.disabled = true;
            buttonText.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...";
            spinner.classList.remove('d-none');

            if (!link) {
                resultDiv.className = 'result-box result-high';
                resultDiv.innerHTML = "âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ§Ù„Ø­ Ù„Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ.";
                resetButton(button, buttonText, spinner);
                return;
            }

            try {
                // âœ… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙˆØ§Ù„Ø£Ø¨Ø³Ø· Ø§Ù„Ø°ÙŠ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ app.py
                const apiUrl = '/check_link'; 
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ link: link })
                });

                const data = await response.json();

                if (data.error) {
                    resultDiv.className = 'result-box result-high';
                    resultDiv.innerHTML = `Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…: ${data.error}`;
                } else {
                    let resultClass = '';
                    if (data.certainty === 'High') {
                        resultClass = 'result-high';
                    } else if (data.certainty === 'Medium') {
                        resultClass = 'result-medium';
                    } else {
                        resultClass = 'result-safe';
                    }
                    
                    resultDiv.className = `result-box ${resultClass}`;
                    resultDiv.innerHTML = `Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„: <strong>${data.result}</strong><br>Ù†Ù‚Ø§Ø· Ø§Ù„Ø´Ùƒ Ø§Ù„Ù…ÙÙƒØªØ´ÙØ©: <strong>${data.score}</strong>`;
                }

            } catch (error) {
                console.error('Fetch Error:', error);
                resultDiv.className = 'result-box result-high';
                resultDiv.innerHTML = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† API Flask ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­."; 
            } finally {
                resetButton(button, buttonText, spinner);
            }
        }
        
        function resetButton(button, buttonText, spinner) {
            button.disabled = false;
            buttonText.textContent = "Ø§ÙØ­Øµ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¢Ù†";
            spinner.classList.add('d-none');
        }
    </script>
</body>
</html>
